# 输入与输出

## 格式输出函数printf()

### printf()函数的使用

- 库函数使用
    - 在头文件中导入`#include <stdio.h>`库，然后直接使用；
    - printf("控制字符串", 输出列表);
    - 控制字符串：普通字符串和转格式说明

一个最简单的`Hello, World!`

```c
#include <stdio.h>  // printf就是在和这个头文件中定义的

int main(void)
{
    printf("Hello, World!");
    return 0;
}
```

- printf家族
    1. printf、fprintf、sprintf、snprintf
    2. vsnprintf

### 输出格式说明

- 控制字符
    - 转义字符：`\r`、`\n`、`\a`、`\t`
- `%[标志][输出宽度][.精度][长度]类型`
    - 其中`[]`是可选项
    - 标志：表述输出数据的特征，比如正负、空格；
    - 输出宽度： 输出固定的宽度位数，不足的位数使用空格或者0填充；
    - 精度：以`.`开头，后跟十进制整数
        1. 若输出的是数字，表示小数的位数；
        2. 若输出的是字符，表示输出字符的个数；
        3. 若实际位数大于定义的精度，超过部分将被截取，但不会改变实际变量的值；
    - 长度：分h\l两种，分别代表短整型和长整型格式输出；

- 常见的输出控制格式

|格式字符|含义|
|:--|:--|
|`%d`|以十进制形式输出由符号整数|
|`%o`|以八进制形式输出无符号整数|
|`%x,%X`|以16进制形式输出无符号整数|
|`%u`|以10进制形式输出无符号整数|
|`%f`|以小数形式输出浮点数|
|`%e,%E,%g`|以指数形式输出浮点数|
|`%c`|输出单个字符|
|`%s`|输出字符串|
|`%p`|输出指针|
|`%%`|输出一个百分号|

### 需要注意的地方

- C99开始支持输出无穷数、NaN、宽字符；
- 常用的一些格式控制符
    1. `%d`：用于转换输出`int`类型的数据
    2. `%hhd`：打印char（C99）
    3. `%u`：用于转换输出unsigned int\short\char
    4. `%lu`：unsigned long
    5. `%llu`：unsigned long long
    6. `%e%g`:指数形式浮点型数据
    7. `%a`：16进制浮点数(C99)
    8. `%le\%lf\%lg`在C99中是合法的，不会再产生未定义行为

## 格式输入函数scanf()

- 调用方式
    1. scanf("控制字符串", 地址列表);
    2. 地址列表中，需要的参数是变量的地址；
    3. 通过取值运算符`&`来获取变量的地址；
    4. 各个变量用逗号隔开，与输出控制符中的转换说明占位符一一对应；
    5. scanf以回车键作为输入结束标识符；

```c
#include <stdio.h>

int main(void)
{
    int i;
    printf("请输入一个数字: ");
    scanf("%d",&i);
    printf("\n你输入的数字是：%d",i);
    return 0;
}
```

### 输出控制格式

```
%[*][输入数据宽度][长度]类型
```

- **[*]：** 表示该输入项读入后不赋值给相应变量；
- **宽度：** 输入的最大十进制宽度
- **长度：** 格式分为l和h，表示长整型、双精度、短整型；
- **类型**
    1. `%d` 输出十进制数
    2. `%o` 输出八进制数
    3. `%x` 输出16进制数
    4. `%c` 输出单个字符
    5. `%s` 输出字符串
    6. `%f/e` 输出浮点型数

## 字符输入输出函数

- 字符输出函数：putchar()

- 字符输入函数：getchar()

```c
#include <stdio.h>

int main(void)
{
    char ch;
    ch = getchar();
    putchar(ch);
    putchar('\n');
    // putchar(getchar());
    return 0;
}
```

### 需要注意的地方

- `getchar`是从标准输入`stdin`中读取一个字符；
    1. `getch()`非缓冲输入，是直接从键盘读取一个字符；
    2. `getchar()`会等到回车后从stdin中读取一个字符，下次如果stdin缓存区不空的话会继续读取；
    3. 该函数有时会放在末尾，从缓冲区读走一个字符，清空缓冲区。也可以使用下面的方式清除回车；
    4. `getchar`只接受单个字符，输入数字也按字符处理，输出多个字符时，只接受第一个字符。
- 使用`getchar`要注意优先级的问题
    1. `while(（ch = getchar()） != '\n')`
- 函数`getchar()`返回值类型是一个整型
    1. 确保返回值在ch表示的范围内
    2. `(ch=getchar()) != EOF`


```c
#include <stdio.h>

int main(void)
{
    char ch;
    int i;
    scanf("%d", &i);
    printf("%d\n",i);
    fflush(stdin); // 清空缓冲区
    ch = getchar();
    putchar(ch);

    putchar('\n');
    return 0;
}
```

## 字符串输入输出函数

输出函数`puts()`，输入函数`gets()`

```c
#include <stdio.h>

int main(void)
{

    char str[50];
    gets(str);
    puts(str);

    puts("Hello, World!"); // 输出，自动添加换行
    return 0;
}
```

### 与printf函数、字符I/O函数的比较

- 字符串结束判断
    1. `scanf`函数读取字符串时以空格、Tab或enter键结束，但此时空格和回车还停留在缓冲区，会影响后面的输入。
    2. gets函数以enter键结束，可以读取有空格的字符串，而且此时回车符没有停留在缓冲区，被转换为字符串结束表示`\O`保存在字符串中。

- 函数`puts`相比`printf`会自动换行
    1. `puts`打印字符串时，会自动将字符串结束表示`\O`转换为换行符。

- `puts`效率比`printf`高
    1. `printf`函数会先对字符串进行格式化转换，然后才进行输出
    2. 比如以`\n`结尾的字符串

- 如果打印一个换行符
    1. 直接使用`putchar("\n");`效率更高

- `gets`函数会造成数组越界的风险，需小心使用
- 最新标准C11已经抛弃了`gets`函数